# URMCNET: An Uncertainty Region Modeling and Calibration Network for Power Line Inspection

## Abstract：
Accurate power line detection is critical for unmanned aerial vehicle (UAV)-based inspection systems. However, the detection accuracy is severely compromised by visually complex backgrounds characterized by similar textures and environmental interference, which often lead to substantial false positives and false negatives in detection results. To address these limitations, we propose a novel Uncertainty Region Modeling and Calibration Network (URMCNet), which incorporates an Uncertainty Region Modeling and Calibration Strategy that explicitly models and calibrates regions prone to false positives and false negatives, so as to enhance the accuracy of power line detection. The core component of URMCNet is the Primary Feature Calibration Mechanism, which incorporates the False-Positive Region Suppression Module and the False-Negative Region Compensation Module. These two modules adaptively calibrate uncertain regions, thereby making the feature representation more accurate and comprehensive. Furthermore, we introduce a High-Frequency Aware Fusion Decoder, which effectively restores the fine-grained details, thereby guaranteeing the continuity of the prediction results. The comprehensive experimental results demonstrate that URMCNet significantly outperforms state-of-the-art methods on several key performance metrics on the publicly available VITLD and TTPLA datasets.

## Note to Practitioners：
UAV-based inspection has become a crucial method for maintaining power grid safety and developing smart grids, especially in remote or hard-to-reach areas. However, existing detection systems often perform poorly in visually complex environments, where power lines may be obscured by trees, buildings, or other obstacles, leading to significant errors that compromise the reliability of inspections and increase maintenance costs. To address these challenges, we propose a new approach that enhances power line detection accuracy by focusing on areas where prediction errors are most likely to occur. Our method employs an adaptive calibration process that specifically targets regions susceptible to false positives and false negatives. This approach enhances detection accuracy and reliability in complex environments, thereby improving the efficiency of UAV-based inspections. Another key contribution of this research is the ability to restore fine details in the detection results, which is crucial for ensuring the continuous detection of power lines in complex or noisy environments. In addition to power line inspection, the techniques proposed can be applied to other fields that also require object detection in complex visual conditions, such as environmental monitoring, infrastructure inspection, and agricultural analysis.

## Overall process model inference:
![image](https://github.com/xmaildottor-spec/An-Uncertainty-Region-Modeling-and-Calibration-Network/blob/main/main.png)
## Dataset：
 1)  VITLD:  The dataset is available at https://bit.ly/3FBYjBY.
 3)  TTPLA:  The dataset is available at https://drive.usercontent.google.com/download?id=1Yz59yXCiPKS0_X4K3x9mW22NLnxjvrr0&export=download&authuser=0

**Dataset Description:**
VITL Dataset.zip
https://pan.baidu.com/s/1gmfbENIXuLGKtdlqYTqrdA?pwd=r8zw r8zw 
* **seed0, seed1**: Original datasets.
* **seed2**: A variant of the original dataset in which the infrared (IR) images are converted to PNG format for better compatibility and visualization.
* **seed2_merge**: A dataset version generated by merging (stitching) the image patches that were split from the original dataset.
* **fn_GT**: Ground-truth labels corresponding to false negative (FN) samples.
* **fp_GT**: Ground-truth labels corresponding to false positive (FP) samples.
  
It is recommended to apply contrast enhancement techniques (such as CLAHE) to the input images before feeding them into the network. 
Our experiments suggest that this pre-processing step can slightly improve the final performance metrics by highlighting texture details.

In the testing stage of this work, we refer to previous studies 【1】【2】【3】【4】, and record the corresponding recall, precision, and average IoU metrics in Table I.

1：Cheng Y, Chen Z, Liu D. PL-UNeXt: per-stage edge detail and line feature guided segmentation for power line detection[C]//2023 IEEE International Conference on Image Processing (ICIP). IEEE, 2023: 261-265.

2：Abdelfattah R, Wang X, Wang S. Plgan: Generative adversarial networks for power-line segmentation in aerial images[J]. IEEE Transactions on Image Processing, 2023, 32: 6248-6259.

3：Choi H, Koo G, Kim B J, et al. Real-time power line detection network using visible light and infrared images[C]//2019 International Conference on Image and Vision Computing New Zealand (IVCNZ). IEEE, 2019: 1-6.

4：Zhang S, Zhang X, Ren W, et al. Bringing RGB and IR Together: Hierarchical Multi-Modal Enhancement for Robust Transmission Line Detection[J]. arXiv preprint arXiv:2501.15099, 2025.

## Notice:
In the original VITLD dataset, every four images correspond to one sliced sample. During testing, please ensure that the images are processed in groups of four and in their original order.

## Acknowledgement:
Thanks 【[Multimodal-FFM-TLD](https://github.com/hyeyeon08/Multimodal-FFM-TLD)】 for providing the relevant training and testing data as well as the associated code.

Due to an incorrect file uploaded during the editing process, the correction is hereby provided as follows:
![image](https://github.com/xmaildottor-spec/An-Uncertainty-Region-Modeling-and-Calibration-Network/blob/main/IMG.png)
Infrared images are included solely for dataset visualization purposes. They are not used in the training or testing phases of the network.


Note: Following the original publication, we further refined the training pipeline and hyperparameters, achieving performance metrics significantly superior to those reported in the paper. The updated training configuration is as follows:
* Optimizer: AdamW (Betas: 0.9, 0.999)
* Learning Rate Strategy: Initial LR of 3e-4 with a Polynomial Decay scheduler (power=0.9).
* Regularization: Weight decay set to 0.005.

These optimized settings allow the model to reach new state-of-the-art results on the dataset.


## Powerline Stereo 3D Reconstruction & UAV Path Planning System 
After obtaining the power line masks, we provide a follow-up stereo-camera 3D reconstruction demo for UAV path planning and obstacle avoidance.

### 1. 3d_demo: Stereo 3D Reconstruction of Power Lines

Input: 
left_mask.png  

right_mask.png

Output:  
pts_cam.txt — 3D points in camera frame  

pts_body.txt — 3D points in UAV body frame 

waypoints.json — generated by the path-planning module

Functionality

Skeleton extraction

Connected-component grouping

Row-wise feature matching

Disparity computation

Stereo triangulation

Camera → body coordinate transformation

### 2. demo_0: Stereo Correspondence Visualization
Displays line-to-line matches between left and right masks with connecting lines.

### 3. demo_1: Matched and Unmatched Point Visualization
Matched points (yellow)

Unmatched points (red)

Line correspondences

Useful for debugging segmentation gaps, occlusion, or matching failures.

### 4. UAV_waypoints: Automatic UAV Path Generation
This module generates a safe inspection trajectory from 3D point clouds.

Key Features

Read stereo masks

Reconstruct 3D point cloud using simple_pipeline_from_masks

Fit a B-spline curve to the powerline

Compute curvature

Determine safe lateral offset

Generate UAV waypoints along the curve

Visualize 3D line + offset path

Output uav_waypoints.json

Parameter Explanation
base_min (Minimum Safety Distance)

Industry-standard 10–30 m depending on voltage level and regulations.

alpha (Curvature Weight)

Larger curvature → larger lateral offset for safety.

Offset Direction

Default: +Y in body frame (right-hand side of the powerline).
To move left: set offset to negative.

### 5. MAVLink / ROS Waypoints Module

Converts uav_waypoints.json into:

MAVLink mission (PX4 / ArduPilot)

ROS2 nav_msgs/Path

Nav2 FollowPath action

Includes:

Body ↔ NED / ENU transformations

PX4 MissionItem construction

ROS2 path publishing

SITL & real flight controller support

### 6. UAV_simu: Open3D 3D Flight Simulation

Provides visual simulation including:

Powerline point cloud

Fitted curve

Offset UAV trajectory

Real-time UAV movement

Visual debugging and demonstration































 
